<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Каталог</title>
<style>
  /* Сброс и базовые стили */
  body {
    font-family: Arial, sans-serif;
    margin: 0; padding: 11px;
    background-color: var(--bg);
    color: var(--text);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  :root {
    --bg: #f5f5f5;
    --text: #222;
    --card-bg: #fff;
    --btn-bg: #0088cc;
    --btn-hover: #0077b3;
    --input-bg: #fff;
    --input-text: #222;
    --border-color: #ccc;
  }

  @media (prefers-color-scheme: dark) {
    :root {
        --bg: #d3f1ff;
        --text: #000000;
        --card-bg: #fff;
        --btn-bg: #005f8c;
        --btn-hover: #004c70;
        --input-bg: #3a3a3a;
        --input-text: #312c2c;
        --border-color: #555;
    }
  }

  h1 {
    text-align: center;
    margin-bottom: 15px;
  }

  .controls {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    align-items: center;
    box-shadow: 0 70px 70px rgb(0 0 0 / 0.2);
    flex-wrap: nowrap; /* чтобы при нехватке места переносились */
    overflow-x: auto;
  }

  .controls button {
    flex-shrink: 1;         /* чтобы кнопки не сжимались меньше заданного */
    flex-grow: 1;           /* чтобы равномерно занимали место */
    min-width: 20px;       /* минимальная ширина кнопки */
    max-width: 40px;       /* максимальная ширина для контроля */
    background-color: #ffffff;
    color: #312c2c;
    border-radius: 25px;
    box-shadow: 0 70px 70px rgb(0 0 0 / 0.2);
    padding: 12px 0;          /* верх/низ 9px, по бокам убрал, ширина фиксируется */
    font-size: 14px;
    border: 1px solid var(--border-color);
    border: none;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
    text-align: center;
  }
 
  .controls button:hover {
    background-color: #ffffff;
    border: 1px solid var(--border-color);
  }

  .controls button:active {
    background-color: #ffffff;
    border: 1px solid var(--border-color);
    transform: scale(0.97);
    transition: transform 0.1s ease;
  }

  input[type="text"], select {
    flex-grow: 1;
    flex-shrink: 1;
    min-width: 100px;    /* минимальная ширина */
    max-width: 300px;    /* максимальная ширина */
    padding: 10px;
    font-size: 16px;
    box-shadow: 0 70px 70px rgb(0 0 0 / 0.2);
    border: 1px solid #ffffff;
    border-radius: 25px;
    background-color: #ffffff;
    color: var(--input-text);
    outline-offset: 2px;
  }

  input[type="text"]::placeholder {
    color: #999;
  }

  #catalog {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 24px;
    margin-bottom: 30px;
  }

  .item {
    background: var(--card-bg);
    border-radius: 25px;
    box-shadow: 0 70px 70px rgb(0 0 0 / 0.2);
    padding: 12px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 80%;
    transition: opacity 0.15s ease, transform 0.15s ease;
    opacity: 1;
  }
  .item.fade-out {
    opacity: 0;
    pointer-events: none;
  }

  .item img {
    width: 100%;
    border-radius: 25px;
    object-fit: cover;
    aspect-ratio: 5 / 3;
    margin-bottom: 12px;
  }

  .item h3 {
    margin: 0 0 6px;
    font-size: 16px;
    line-height: 1.2;
  }

  .item p {
    font-size: 14px;
    color: var(--text);
    flex-grow: 1;
    margin-bottom: 8px;
  }

  .price {
    font-weight: 700;
    color: #000000;
    margin-bottom: 10px;
    font-size: 16px;
  }

  button {
    background-color: var(--btn-bg);
    border: none;
    border-radius: 25px;
    color: white;
    padding: 9px 0;
    font-size: 16px;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
    transform: scale(0.95);
    transition: transform 0.1s ease;
    width: 100%;
  }

  button:active {
    background-color: var(--btn-hover);
    transform: scale(0.95);
    transition: transform 0.1s ease;
  }

  button:hover {
    background-color: var(--btn-hover);
  }
  #scrollTopBtn {
    position: fixed;
    bottom: 40px;
    right: 40px;
    z-index: 1000;
    background-color: #c2deeb96;
    color: white;
    border: none;
    border-radius: 50%;
    width: 44px;
    height: 44px;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    transition: opacity 0.3s ease;
    opacity: 0;
    pointer-events: none;
  }

  #scrollTopBtn.show {
    opacity: 1;
    pointer-events: auto;
  }

/* Футер с магазином и ссылкой */
  #footer {
    text-align: center;
    margin-top: 20px;
    font-size: 15px;
    color: #555;
  }

  #footer button {
    margin-top: 8px;
    width: auto;
    padding: 10px 20px;
  }

  /* Адаптация под мобильные экраны */
  @media (max-width: 768px) {
    #catalog {
      grid-template-columns: repeat(2, 1fr);
      gap: 20px 20px;
    }
    .item {
      height: 360px;
    }
  }
  @media (max-width: 480px) {
    #catalog {
      grid-template-columns: 1fr;
      gap: 18px 18px;
    }
    .item {
      height: 380px;
    }
  }
</style>
</head>
<body>

<h1>Ah! Margo! Cake SPb</h1>

<div class="controls">
  <input id="search" type="text" placeholder="Поиск по названию..." autocomplete="off" />
  <select id="category">
    <option value="">Все категории</option>
  </select>
  <button id="sortPriceBtn" title="▲▼">▲▼</button>
</div>

<div id="catalog">Загрузка...</div>

<div id="footer">
  <div>Магазин <b>«ТвойКаталог»</b></div>
  <button onclick="openTelegramChannel()">Перейти в наш Telegram-канал</button>
</div>
<button id="scrollTopBtn" title="Наверх">↑</button>
<script>
  const TELEGRAM_USERNAME = "loobw";

  const items = [
    {
      id: "1",
      category: "Торты",
      name: "ТРИ ШОКОЛАДА",
      description: "Описание",
      price: "10 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "2",
      category: "Торты",
      name: "Королевская Диабелла",
      description: "Описание",
      price: "90 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "3",
      category: "Торты",
      name: "Пряная морковь/апельсин",
      description: "Описание",
      price: "150 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "4",
      category: "Торты",
      name: "Черный лес",
      description: "Описание",
      price: "100 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "5",
      category: "Торты",
      name: "Сливочная черника",
      description: "Описание",
      price: "25 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "6",
      category: "Моти",
      name: "Черничный йогурт",
      description: "Описание",
      price: "1000 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "7",
      category: "Моти",
      name: "Малина-фисташка",
      description: "Описание",
      price: "1 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "8",
      category: "Моти",
      name: "Love is… клубника/банан",
      description: "Описание",
      price: "15 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "9",
      category: "Моти",
      name: "Пина Колада (ананас/кокос)",
      description: "Описание",
      price: "40 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "10",
      category: "Пирожные",
      name: "«Картошка» 6 шт",
      description: "Описание",
      price: "700 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    },
    {
      id: "11",
      category: "Пирожные",
      name: "«Картошка» 12 шт",
      description: "Описание",
      price: "1200 ₽",
      image: "https://sun9-55.userapi.com/impg/Qu8bWmXxJQZIti5bDfebr6lJnf8XcTdZ5Gv3kg/8a73ZrZqYIk.jpg?size=604x604&quality=95&sign=1528701276b7d3b5f9eef97e4d8be2b2&type=album"
    }
  ];

  function fillCategories() {
    const select = document.getElementById("category");
    const cats = [...new Set(items.map(i => i.category))].sort();
    cats.forEach(c => {
      const opt = document.createElement("option");
      opt.value = c;
      opt.textContent = c;
      select.appendChild(opt);
    });
  }

  let sortAsc = true;  // true — по возрастанию, false — по убыванию

  document.getElementById("sortPriceBtn").addEventListener("click", () => {
    sortAsc = !sortAsc;
    document.getElementById("sortPriceBtn").textContent = sortAsc ? "▲" : "▼";
    renderCatalog();
  });

  function priceToNumber(priceStr) {
    return Number(priceStr.replace(/\D/g, ""));
  }

  function renderCatalog() {
    const search = document.getElementById("search").value.toLowerCase();
    const category = document.getElementById("category").value;
    const catalogDiv = document.getElementById("catalog");

  // Получаем текущие карточки и скрываем их с анимацией
    const currentItems = Array.from(catalogDiv.children);
    currentItems.forEach(item => item.classList.add('fade-out'));

    setTimeout(() => {
      catalogDiv.innerHTML = "";

      let filtered = items.filter(i =>
        (!category || i.category === category) &&
        (!search || i.name.toLowerCase().includes(search))
      );

      filtered.sort((a, b) => {
        const priceA = priceToNumber(a.price);
        const priceB = priceToNumber(b.price);
        return sortAsc ? priceA - priceB : priceB - priceA;
      });

      if (filtered.length === 0) {
        catalogDiv.innerHTML = "<p>Ничего не найдено.</p>";
        return;
      }

      filtered.forEach(i => {
        const div = document.createElement("div");
        div.className = "item fade-out";  // начинаем с прозрачности 0
        div.innerHTML = `
          <img src="${i.image}" alt="${i.name}" loading="lazy" />
          <h3>${i.name}</h3>
          <p>${i.description}</p>
          <div class="price">${i.price}</div>
          <button onclick="orderItem('${i.name.replace(/'/g, "\\'")}')">Заказать</button>
        `;
        catalogDiv.appendChild(div);

      // Через небольшой таймаут включаем плавное появление
        setTimeout(() => {
          div.classList.remove('fade-out');
        }, 50);
      });
    }, 300);  // время совпадает с transition в CSS
  }


  function orderItem(name) {
    const message = encodeURIComponent(`Здравствуйте! Хочу заказать: ${name}`);
    window.open(`https://t.me/${TELEGRAM_USERNAME}?text=${message}`, "_blank");
  }

  document.getElementById("search").addEventListener("input", renderCatalog);
  document.getElementById("category").addEventListener("change", renderCatalog);

  // Запускаем заполнение и рендер сразу
  fillCategories();
  renderCatalog();
const scrollTopBtn = document.getElementById("scrollTopBtn");

window.addEventListener("scroll", () => {
  if (window.scrollY > 300) {
    scrollTopBtn.classList.add("show");
  } else {
    scrollTopBtn.classList.remove("show");
  }
});

scrollTopBtn.addEventListener("click", () => {
  window.scrollTo({ top: 0, behavior: "smooth" });
});
</script>
</body>
</html>


